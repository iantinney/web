# Phase 12-01 Plan: Rich Seed Data + Cross-Plan Structure

**Sub-phase:** 12-01
**Estimated Duration:** 1.5â€“2 hours
**Critical Path:** YES (all other phases depend on this)
**Autonomous:** Manual (data creation + review)

---

## Objective

Create a fully-populated demo state across two interconnected study plans that makes every feature in Phase 12 (and Phase 11) immediately interesting. No cold starts, no empty graphs, no loading screens.

**What Gets Seeded:**
- 2 study plans: "Linear Algebra Fundamentals" (partial mastery) + "Intro to ML" (active)
- 15 total concepts across both plans
- Cross-plan edge mappings (ML concepts that depend on Linear Algebra)
- Pre-fetched Wikipedia source chunks for all 15 concepts (45â€“60 chunks, ~200 words each)
- Chat history (5â€“10 learner + tutor messages)
- Session records (3â€“5 practice sessions with attempt data)
- Learner profile (background, goals, interests from Phase 6)
- Proficiency snapshots (mix of 0%, 30%, 70%, 90%)

---

## Design Philosophy

**Anti-pattern:** "Empty app that shows loading screens"
**Pattern:** "App that opens with rich context already established"

Each seeded element serves a purpose:
- **Partial mastery in Linear Algebra** â†’ Makes ghost nodes meaningful ("Oh, they've already started this")
- **Mix of proficiency levels in ML** â†’ Demonstrates locked concepts, practice opportunities
- **Chat history** â†’ Feels lived-in; explains why the tutor has context
- **Pre-fetched sources** â†’ Demo works without network; citations are instant
- **Multiple sessions** â†’ Stats feel real; learner appears engaged

---

## Data Structure

### Study Plan 1: Linear Algebra Fundamentals

```json
{
  "id": "linear-algebra-plan-1",
  "userId": "demo-user-1",
  "title": "Linear Algebra Fundamentals",
  "description": "Build a foundation in linear algebra for machine learning",
  "sourceText": "This course covers vectors, matrices, eigenvalues, and their applications...",
  "status": "in_progress",
  "createdAt": "2025-12-15",
  "updatedAt": "2026-02-20"
}
```

**Concepts (8 total):**
| ID | Name | Tier | Proficiency | Prerequisites | Notes |
|----|------|------|-------------|---------------|-------|
| la-1 | Vectors & Dot Products | 1 | 90% | none | âœ… Mastered; acts as prerequisite for ML |
| la-2 | Matrix Multiplication | 1 | 85% | none | âœ… Mastered |
| la-3 | Linear Transformations | 2 | 70% | la-1, la-2 | ðŸŸ¡ In progress |
| la-4 | Eigenvalues & Eigenvectors | 2 | 70% | la-2, la-3 | ðŸŸ¡ In progress; referenced by ML |
| la-5 | Determinants | 1 | 50% | la-2 | ðŸŸ¡ In progress |
| la-6 | Matrix Decomposition | 3 | 40% | la-4, la-5 | ðŸŸ¡ In progress |
| la-7 | Singular Value Decomposition | 3 | 20% | la-6 | ðŸ”´ Early stage |
| la-8 | Applications to ML | 3 | 10% | la-4, la-6 | ðŸ”´ Locked (depends on la-6 < 70%) |

### Study Plan 2: Intro to Machine Learning

```json
{
  "id": "intro-ml-plan-1",
  "userId": "demo-user-1",
  "title": "Intro to Machine Learning",
  "description": "Core machine learning concepts with hands-on practice",
  "sourceText": "This curriculum covers supervised and unsupervised learning...",
  "status": "active",
  "createdAt": "2026-02-18",
  "updatedAt": "2026-02-27"
}
```

**Concepts (15 total; 7 are ghost nodes):**
| ID | Name | Tier | Proficiency | Prerequisites | Ghost? | Notes |
|----|------|------|-------------|---------------|--------|-------|
| ml-1 | Supervised vs Unsupervised | 1 | 90% | none | No | âœ… Mastered |
| ml-2 | Feature Engineering | 1 | 80% | none | No | âœ… Mastered; used in examples |
| ml-3 | Linear Regression | 2 | 75% | ml-1 | Yes: la-1 | ðŸŸ¡ In progress; demo topic |
| ml-4 | Cost Functions (MSE/MAE) | 2 | 55% | ml-3 | Yes: la-4 | ðŸŸ¡ In progress; sources available |
| ml-5 | Gradient Descent | 2 | 45% | ml-4 | Yes: [EXT] Derivatives | ðŸŸ¡ In progress; Phase 11 insertion trigger |
| ml-6 | Neural Network Basics | 2 | 30% | ml-3 | No | ðŸ”´ Early stage |
| ml-7 | Backpropagation | 3 | 10% | ml-6 | Yes: [EXT] Chain Rule | ðŸ”´ LOW; seeded for gap insertion demo |
| ml-8 | Overfitting & Regularization | 3 | 0% | ml-4, ml-6 | No | ðŸ”´ LOCKED (ml-6 < 70%) |
| ml-9 | Decision Trees | 2 | 0% | ml-1, ml-2 | No | ðŸ”´ LOCKED; seeded for extension demo |
| ml-10 | k-NN Classification | 2 | 0% | ml-1, ml-2 | No | ðŸ”´ Not started |
| ml-11 | Support Vector Machines | 3 | 0% | ml-4, ml-5 | No | ðŸ”´ Locked (ml-5 < 70%) |
| ml-12 | Clustering Algorithms | 2 | 0% | ml-1 | No | ðŸ”´ Not started |
| ml-13 | Dimensionality Reduction | 3 | 0% | ml-4, ml-12 | Yes: la-7 | ðŸ”´ Locked |
| ml-14 | Ensemble Methods | 3 | 0% | ml-9, ml-11 | No | ðŸ”´ Locked |
| ml-15 | Time Series Analysis | 2 | 0% | none | No | ðŸ”´ Not started |

**[EXT]** = Ghost node (will be inserted via Phase 11 on demand)

### Cross-Plan Edges

These represent ML concepts that require Linear Algebra prerequisites:

```json
[
  {
    "fromStudyPlanId": "linear-algebra-plan-1",
    "fromConceptId": "la-1",
    "toStudyPlanId": "intro-ml-plan-1",
    "toConceptId": "ml-3",
    "edgeType": "prerequisite",
    "label": "Vectors are the foundation of linear regression"
  },
  {
    "fromStudyPlanId": "linear-algebra-plan-1",
    "fromConceptId": "la-4",
    "toStudyPlanId": "intro-ml-plan-1",
    "toConceptId": "ml-4",
    "edgeType": "prerequisite",
    "label": "Eigenvalues relate to matrix operations in cost functions"
  },
  {
    "fromStudyPlanId": "linear-algebra-plan-1",
    "fromConceptId": "la-7",
    "toStudyPlanId": "intro-ml-plan-1",
    "toConceptId": "ml-13",
    "edgeType": "prerequisite",
    "label": "SVD is used in dimensionality reduction"
  }
]
```

---

## Wikipedia Source Chunks

Each of the 15 concepts needs 3â€“4 source chunks (~200 words each). These are **pre-fetched during seeding** to eliminate network dependency.

**Schema:**
```typescript
interface SourceChunk {
  id: string; // "chunk-la-1-001"
  conceptNodeId: string; // "la-1"
  source: "wikipedia" | "wikibooks";
  pageTitle: string; // "Vector (mathematics and physics)"
  pageUrl: string; // "https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)"
  sectionHeading: string; // "Definition and representation"
  content: string; // ~200 words of actual Wikipedia text
  relevanceScore: number; // 0.95 (from search API, or manually set)
}
```

**Example chunks (minimal):**

```json
{
  "id": "chunk-la-1-001",
  "conceptNodeId": "la-1",
  "source": "wikipedia",
  "pageTitle": "Vector (mathematics and physics)",
  "pageUrl": "https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)",
  "sectionHeading": "Definition and representation",
  "content": "In mathematics and physics, a vector is an element of a vector space. Geometrically, vectors are often represented with an initial point and a terminal point. In the context of Euclidean geometry, the term 'vector' is used to denote a quantity with both magnitude and direction. The dot product of two vectors u and v is defined as uÂ·v = |u||v|cos(Î¸), where Î¸ is the angle between them. This fundamental operation is used throughout linear algebra and applications in machine learning.",
  "relevanceScore": 0.98
},
{
  "id": "chunk-la-1-002",
  "conceptNodeId": "la-1",
  "source": "wikipedia",
  "pageTitle": "Linear algebra",
  "pageUrl": "https://en.wikipedia.org/wiki/Linear_algebra",
  "sectionHeading": "Introduction",
  "content": "Linear algebra is the branch of mathematics concerning linear equations, linear maps, and their representations in vector spaces and through matrices. Linear algebra is central to almost all areas of mathematics, and is relevant to practical applications ranging from machine learning to computer graphics. The study of vectors and their operations forms the foundation for more advanced topics such as matrix operations and eigenvalue decomposition.",
  "relevanceScore": 0.92
}
```

**Source Chunks Inventory (minimum):**
- **la-1** (Vectors & Dot Products): 3 chunks âœ“
- **la-2** (Matrix Multiplication): 3 chunks âœ“
- **la-3** (Linear Transformations): 3 chunks âœ“
- **la-4** (Eigenvalues & Eigenvectors): 3 chunks âœ“
- **la-5** (Determinants): 2 chunks âœ“
- **la-6** (Matrix Decomposition): 2 chunks âœ“
- **la-7** (SVD): 2 chunks âœ“
- **la-8** (ML Applications): 2 chunks âœ“
- **ml-1** (Supervised vs Unsupervised): 3 chunks âœ“
- **ml-2** (Feature Engineering): 3 chunks âœ“
- **ml-3** (Linear Regression): 4 chunks âœ“
- **ml-4** (Cost Functions): 4 chunks âœ“
- **ml-5** (Gradient Descent): 4 chunks âœ“
- **ml-6** (Neural Network Basics): 3 chunks âœ“
- **ml-7** (Backpropagation): 4 chunks âœ“

**Total: ~45 chunks** (~9,000 words)

**How to Acquire:**
Option A (Recommended): Manually copy from Wikipedia articles (legit with attribution)
Option B (Faster): Use a local Wikipedia dump + regex extraction
Option C (Fastest): Create synthetic summaries that mimic Wikipedia style (for demo only, mark as synthetic)

For the hackathon, **Option A is best** â€” real Wikipedia text adds credibility, and attribution is free.

---

## Chat History

Pre-seed 5â€“10 messages in the Chat tab to show the learner + tutor have history:

```json
[
  {
    "id": "msg-1",
    "role": "user",
    "content": "I want to learn machine learning, but I need a foundation in linear algebra first. Can you create a learning plan?",
    "timestamp": "2026-02-18T10:00:00Z"
  },
  {
    "id": "msg-2",
    "role": "assistant",
    "content": "Great question! I can help you build a structured learning path. I'll create two interconnected study plans: one for linear algebra fundamentals, and another for ML that builds on top. This way, you'll see how your linear algebra knowledge directly applies to machine learning concepts. Let me generate your concept graphs now.",
    "timestamp": "2026-02-18T10:01:00Z"
  },
  {
    "id": "msg-3",
    "role": "user",
    "content": "Perfect! I already know some algebra and basic calculus. I want to focus on practical applications in ML.",
    "timestamp": "2026-02-18T10:05:00Z"
  },
  {
    "id": "msg-4",
    "role": "assistant",
    "content": "Excellent. I've created your learning plans. You have 8 concepts in linear algebra and 15 in machine learning. Notice that some ML concepts reference your linear algebra topicsâ€”I'll highlight these as 'ghost nodes' to show the connections. Your background in calculus will help especially with gradient descent and backpropagation. Let's start with practice!",
    "timestamp": "2026-02-18T10:10:00Z"
  },
  {
    "id": "msg-5",
    "role": "user",
    "content": "How does the system know what I should practice next?",
    "timestamp": "2026-02-20T14:30:00Z"
  },
  {
    "id": "msg-6",
    "role": "assistant",
    "content": "I use a few signals: your current proficiency in each topic, which concepts have available prerequisites, and your learning velocity. Based on your progress so far, you're ready to deepen your linear regression understanding and move toward gradient descent. The practice questions adapt in difficulty based on your accuracy.",
    "timestamp": "2026-02-20T14:31:00Z"
  }
]
```

---

## Session & Attempt Records

Create 3â€“5 past practice sessions to show the learner's history and make stats real:

```json
{
  "id": "session-1",
  "studyPlanId": "linear-algebra-plan-1",
  "conceptId": "la-1",
  "userId": "demo-user-1",
  "startedAt": "2026-02-19T09:00:00Z",
  "completedAt": "2026-02-19T09:15:00Z",
  "totalQuestions": 5,
  "correctAnswers": 5,
  "accuracy": 100,
  "proficiencyBefore": 0.85,
  "proficiencyAfter": 0.92,
  "attempts": [
    {
      "id": "attempt-1-1",
      "questionId": "q-la-1-001",
      "questionType": "multiple_choice",
      "userAnswer": "The dot product produces a scalar value",
      "correctAnswer": true,
      "isCorrect": true,
      "timestamp": "2026-02-19T09:01:00Z"
    },
    // ... more attempts
  ]
}
```

**Sessions to create:**
1. **Session 1:** LA-1 (Vectors), 5 questions, 100% accuracy (5/5)
2. **Session 2:** LA-2 (Matrix Mult), 5 questions, 80% accuracy (4/5)
3. **Session 3:** ML-3 (Linear Regression), 4 questions, 75% accuracy (3/4)
4. **Session 4:** ML-5 (Gradient Descent), 3 questions, 66% accuracy (2/3) â€” Mixed performance
5. **Session 5:** ML-1 (Supervised), 5 questions, 100% accuracy (5/5) â€” Recent win

These sessions establish:
- Learner has some momentum (multiple sessions completed)
- Mixed performance (not perfect, feels realistic)
- Recent session shows they're actively learning

---

## Learner Profile (Phase 6 Integration)

Seed the learner profile with background, goals, and interests:

```json
{
  "userId": "demo-user-1",
  "background": [
    "background:software-engineer",
    "background:self-taught-math"
  ],
  "goals": [
    "goal:transition-to-ml",
    "goal:understand-deep-learning"
  ],
  "interests": [
    "interest:computer-vision",
    "interest:nlp"
  ]
}
```

**Why?** The tutor can reference this in proposals:
- "Based on your interest in computer vision, feature engineering is critical"
- "As a software engineer, you'll appreciate how these matrix operations relate to GPU programming"

---

## Implementation: Files to Create/Modify

### New Files

1. **`prisma/seed-demo-cross-graph.ts`** (new)
   - Main seed script that orchestrates everything
   - Creates users, study plans, concepts, edges, chat, sessions, sources, profile
   - Called by `npm run seed` with appropriate flag

2. **`src/lib/seed-data/linear-algebra.json`** (new)
   - Linear Algebra plan structure (concepts, edges, proficiency)

3. **`src/lib/seed-data/ml-plan.json`** (new)
   - ML plan structure (concepts, edges, proficiency)

4. **`src/lib/seed-data/cross-plan-edges.json`** (new)
   - Cross-plan edge mappings

5. **`src/lib/seed-data/wikipedia-chunks.json`** (new)
   - All 45+ pre-fetched Wikipedia source chunks
   - Organized by concept ID

6. **`src/lib/seed-data/chat-history.json`** (new)
   - Pre-seeded chat messages

7. **`src/lib/seed-data/sessions.json`** (new)
   - 5 past practice sessions with attempt records

---

### Modified Files

1. **`prisma/schema.prisma`** (modify)
   - Ensure `SourceChunk` table exists
   - Ensure `LearnerProfile` table exists (from Phase 6)

2. **`package.json`** (modify)
   - Add seed script: `"seed:demo": "node -r tsx/cjs prisma/seed-demo-cross-graph.ts"`
   - Or integrate into existing `seed` script with `SEED_MODE=demo`

---

## Implementation Tasks (Step-by-Step)

### Task 1: Acquire Wikipedia Source Chunks
**Time: 30 min**

For each of the 15 concepts, copy 3â€“4 relevant passages from Wikipedia:
1. Open https://en.wikipedia.org/wiki/[topic]
2. Find relevant sections (Definition, Overview, Applications, etc.)
3. Copy ~200 words per section
4. Paste into `wikipedia-chunks.json` with metadata

**Example workflow:**
```
1. Open https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)
2. Copy "Definition and representation" section (~200 words)
3. Store in JSON:
   {
     "conceptNodeId": "la-1",
     "pageTitle": "Vector (mathematics and physics)",
     "sectionHeading": "Definition and representation",
     "content": "<copied text>"
   }
4. Repeat for 44 more chunks
```

**Quality check:** Each chunk should:
- âœ… Be ~150â€“250 words (roughly a paragraph)
- âœ… Have a clear section heading
- âœ… Be coherent on its own (not mid-sentence)
- âœ… Cite from a reputable Wikipedia article

### Task 2: Structure Concept Maps
**Time: 20 min**

Translate the concept tables above into JSON:
```json
// src/lib/seed-data/linear-algebra.json
{
  "plan": {
    "id": "linear-algebra-plan-1",
    "title": "Linear Algebra Fundamentals",
    "description": "...",
    "sourceText": "..."
  },
  "concepts": [
    {
      "id": "la-1",
      "name": "Vectors & Dot Products",
      "description": "...",
      "depthTier": 1,
      "proficiency": 0.90,
      "conceptType": "foundation"
    },
    // ... 7 more
  ],
  "edges": [
    {
      "from": "la-1",
      "to": "la-3",
      "edgeType": "prerequisite"
    },
    // ...
  ]
}
```

### Task 3: Define Cross-Plan Edges
**Time: 15 min**

Create `cross-plan-edges.json` with 3 mappings:
```json
[
  {
    "fromStudyPlanId": "linear-algebra-plan-1",
    "fromConceptId": "la-1",
    "toStudyPlanId": "intro-ml-plan-1",
    "toConceptId": "ml-3"
  },
  // ... 2 more
]
```

### Task 4: Create Chat History
**Time: 20 min**

Write 6â€“10 realistic messages (learner + assistant) showing:
- Learner asks for help with ML
- Assistant offers to create interconnected plans
- Learner mentions background (algebra + calculus)
- Assistant confirms, explains how system works
- Later, learner asks about practice algorithm
- Assistant explains

### Task 5: Create Session/Attempt Records
**Time: 20 min**

Create `sessions.json` with 5 entries:
- Each session has 3â€“5 questions answered
- Accuracy ranges from 66%â€“100%
- Times are staggered (different dates)
- Proficiency deltas show realistic SM-2 updates

### Task 6: Write Seed Script
**Time: 30 min**

Write `seed-demo-cross-graph.ts`:
```typescript
import { db } from '@/lib/db';
import linearAlgebraSeed from '@/lib/seed-data/linear-algebra.json';
import mlSeed from '@/lib/seed-data/ml-plan.json';
import crossPlanEdges from '@/lib/seed-data/cross-plan-edges.json';
import wikipediaChunks from '@/lib/seed-data/wikipedia-chunks.json';
import chatHistory from '@/lib/seed-data/chat-history.json';
import sessions from '@/lib/seed-data/sessions.json';

async function main() {
  // 1. Create user
  const user = await db.user.create({
    data: {
      id: 'demo-user-1',
      email: 'demo@example.com',
      name: 'Demo Learner',
      learnerProfile: {
        background: ['background:software-engineer'],
        goals: ['goal:transition-to-ml'],
        interests: ['interest:computer-vision']
      }
    }
  });

  // 2. Create Linear Algebra study plan + concepts + edges
  const laPlan = await createPlan(user.id, linearAlgebraSeed);

  // 3. Create ML study plan + concepts + edges
  const mlPlan = await createPlan(user.id, mlSeed);

  // 4. Create cross-plan edges (stored separately)
  await Promise.all(crossPlanEdges.map(edge =>
    db.crossPlanEdge.create({ data: edge })
  ));

  // 5. Populate Wikipedia chunks
  await Promise.all(wikipediaChunks.map(chunk =>
    db.sourceChunk.create({ data: chunk })
  ));

  // 6. Seed chat history
  await Promise.all(chatHistory.map(msg =>
    db.chatMessage.create({ data: { ...msg, userId: user.id } })
  ));

  // 7. Create practice sessions + attempts
  await Promise.all(sessions.map(session =>
    createSession(user.id, session)
  ));

  console.log('âœ… Demo seed complete!');
}

main();
```

### Task 7: Test & Verify
**Time: 15 min**

```bash
# Run seed script
npm run seed:demo

# Verify in database
npx prisma studio

# Check app
npm run dev
# Open http://localhost:3000
# Verify:
# âœ… Two study plans visible in sidebar
# âœ… Each plan has 8â€“15 concepts
# âœ… Proficiency mix (0%â€“90%)
# âœ… Chat history shows 6 messages
# âœ… Sessions show practice history
```

---

## Success Criteria

### Data Completeness
- âœ… 2 study plans created (LA + ML)
- âœ… 15 total concepts across both plans
- âœ… All concepts have proficiency values (mix of 0â€“90%)
- âœ… Prerequisites correctly linked (no circular deps)
- âœ… 3 cross-plan edges created (LA â†’ ML)

### Wikipedia Sources
- âœ… 45+ source chunks in database
- âœ… Each concept has 2â€“4 chunks
- âœ… Chunks are ~150â€“250 words each
- âœ… All chunks have valid pageTitle + pageUrl
- âœ… All chunks link to real Wikipedia articles

### Chat & Sessions
- âœ… 6â€“10 chat messages exist
- âœ… Messages alternate user â†” assistant
- âœ… 5 practice sessions with attempt records
- âœ… Session accuracy ranges from 66%â€“100%
- âœ… Proficiency deltas are realistic (Â±5â€“10%)

### Learner Profile
- âœ… User has background tags
- âœ… User has goal tags
- âœ… User has interest tags
- âœ… Tags are used in seeded demo triggers

### UI Verification
- âœ… App opens to demo user (no login needed for demo)
- âœ… Sidebar shows 2 study plans
- âœ… Graph tab shows ML plan with concepts
- âœ… Learn tab can load a concept and show practice
- âœ… Chat tab shows seeded history
- âœ… No errors in browser console

---

## Timeline

| Task | Time | Owner |
|------|------|-------|
| Acquire Wikipedia chunks | 30m | You |
| Structure concept maps (JSON) | 20m | You |
| Define cross-plan edges | 15m | You |
| Create chat history | 20m | You |
| Create session records | 20m | You |
| Write seed script | 30m | You |
| Test & verify | 15m | You |
| **Total** | **~2 hours** | |

---

## Fallback Strategy

If you get stuck on any step:

**No Wikipedia chunks?** Use synthetic summaries that mimic Wikipedia style (clearly marked as demo data).
**No chat history?** Start with 2â€“3 messages (minimum viable).
**No session records?** App still works; just shows empty stats (less impressive).
**Seed script too complex?** Use JSON files + manual database inserts via Prisma Studio (slower but works).

**Minimum viable 12-01:** 2 study plans + concepts + cross-plan edges = 1 hour. Sources and chat can be added afterward.

---

## Next Phase Dependencies

Phase 12-02 (Ghost Nodes) needs:
- âœ… Cross-plan edges from this phase

Phase 12-03 (Wikipedia Integration) needs:
- âœ… Wikipedia chunks from this phase

Phase 12-04 (Demo Flow) needs:
- âœ… All of the above + concept IDs + profile

---

*Phase 12-01 implementation plan ready for execution.*
